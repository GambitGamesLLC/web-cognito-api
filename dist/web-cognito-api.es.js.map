{"version":3,"file":"web-cognito-api.es.js","sources":["../src/configure/configure-api.js","../src/sign-up/sign-up-api.js","../src/confirm-sign-up/confirm-sign-up-api.js","../src/cognito-api-manager.js"],"sourcesContent":["/**\r\n * configure-api.js\r\n * @file Handles API requests related to configuring the Amplify Api.\r\n * @description Provides a singleton class, `ConfigureApi`. \r\n * This file centralizes all Amplify configuration logic.\r\n * The `ConfigureApi` class here is created automatically by the CognitoApiManager class during construction\r\n * @exports {ConfigureApi}\r\n * @requires {CognitoApiManager} from '../cognito-api-manager.js'\r\n * @requires {Joi} for schema validation\r\n */\r\n\r\n//#region IMPORTS\r\n\r\n// Importing Amplify From the AWS Amplify Lib\r\nimport { Amplify } from '@aws-amplify/core';\r\n\r\n/**\r\n * @typedef {import('@aws-amplify/core').ResourcesConfig} ResourcesConfig\r\n */\r\n\r\n//#endregion\r\n\r\n/**\r\n * Handles configuration of the AWS Amplify Api\r\n */\r\nexport class ConfigureApi \r\n{\r\n\r\n    //#region PRIVATE - VARIABLES\r\n\r\n    //#endregion\r\n\r\n    //#region PUBLIC - CONSTRUCTOR\r\n\r\n    /**\r\n     * Constructor for the Api\r\n     */\r\n    //----------------------------------------------//\r\n    constructor() \r\n    //----------------------------------------------//\r\n    {\r\n\r\n    } //END Constructor Method\r\n\r\n    //#endregion\r\n\r\n    //#region PUBLIC - CONFIGURE\r\n\r\n    /**\r\n     * Sets the Amplify configuration file\r\n     * \r\n     * @documentation https://docs.amplify.aws/javascript/start/connect-to-aws-resources/\r\n     * \r\n     * @param {ResourcesConfig} config The 'amplifyconfiguration.json' config file\r\n     * @returns {Promise<ResourcesConfig>} The resources configuration set up with Amplify\r\n     */\r\n    // ----------------------------------------------------------------- //\r\n    async Configure( config ) \r\n    // ----------------------------------------------------------------- //\r\n    {\r\n        if( config === undefined || config === null )\r\n        {\r\n            throw new Error( \"web-cognito-api configure.js Configure() passed in 'config' parameter is undefined or null\" );\r\n        }\r\n\r\n        try\r\n        {\r\n            /**\r\n             * Passes our configuration file into the core Amplify object\r\n             */\r\n            Amplify.configure(config);\r\n\r\n            return await Amplify.getConfig();\r\n        }\r\n        catch(error)\r\n        {\r\n            // Re-throw the error to ensure the promise is rejected.\r\n            throw new Error( `web-cognito-api configure.js Configure() Error: ${error.message}` );\r\n        }\r\n        \r\n    } //END Configure() Method\r\n\r\n    //#endregion\r\n    \r\n} //END ConfigureApi Class","/**\r\n * sign-up-api.js\r\n * @file Handles API requests related to sign-up with the Amplify Cognito Api.\r\n * @description Provides a singleton class, `SignUpApi`. \r\n * This file centralizes all Amplify Cognito sign-up logic.\r\n * The `SignUpApi` class here is created automatically by the CognitoApiManager class during construction\r\n * @exports {SignUpApi}\r\n * @requires {CognitoApiManager} from '../cognito-api-manager.js'\r\n * @requires {Joi} for schema validation\r\n */\r\n\r\n//#region IMPORTS\r\n\r\n// Importing Amplify From the AWS Amplify Lib\r\nimport { Amplify } from '@aws-amplify/core';\r\n\r\n// Import the signUp method from the auth library\r\nimport { signUp } from '@aws-amplify/auth';\r\n\r\n/**\r\n * @typedef {import('@aws-amplify/core').ResourcesConfig} ResourcesConfig\r\n * @typedef {import('@aws-amplify/auth/dist/esm/types').AuthNextSignUpStep} AuthNextSignUpStep\r\n * @typedef {import('@aws-amplify/auth').SignUpOutput} SignUpOutput\r\n */\r\n\r\n//#endregion\r\n\r\n/**\r\n * Handles sign-up logic within the AWS Amplify Api\r\n */\r\nexport class SignUpApi \r\n{\r\n\r\n    //#region PRIVATE - VARIABLES\r\n\r\n    //#endregion\r\n\r\n    //#region PUBLIC - CONSTRUCTOR\r\n\r\n    /**\r\n     * Constructor for the Api\r\n     */\r\n    //----------------------------------------------//\r\n    constructor() \r\n    //----------------------------------------------//\r\n    {\r\n\r\n    } //END Constructor Method\r\n\r\n    //#endregion\r\n\r\n    //#region PUBLIC - SIGN UP\r\n\r\n    /**\r\n     * Creates a new user within the Cognito user pool. \r\n     * Check the `SignUpOutput` variable for the next step, usually you'll need to pass in a code to continue sign up\r\n     * \r\n     * @documentation https://docs.amplify.aws/javascript/build-a-backend/auth/connect-your-frontend/sign-up/\r\n     * \r\n     * @param {string} username The name for the new user. Specific format depends on the user pool settings in your AWS console.\r\n     * @param {string} password The password for the new user\r\n     * @param {object | null} attributes [Optional] An object of user attributes, e.g., { email: 'user@example.com' }\r\n     * @returns {Promise<SignUpOutput>} The 'SignUpOutput' property returned by Amplify after a user is successfully created in the user pool\r\n     */\r\n    // ----------------------------------------------------------------- //\r\n    async SignUp( username, password, attributes ) \r\n    // ----------------------------------------------------------------- //\r\n    {\r\n        if (!username) \r\n        {\r\n            throw new Error(\"web-cognito-api sign-up-api.js SignUp() Error: username cannot be null, undefined, or empty.\" );\r\n        }\r\n\r\n        if (!password) \r\n        {\r\n            throw new Error(\"web-cognito-api sign-up-api SignUp() Error: password cannot be null, undefined, or empty.\" );\r\n        }\r\n\r\n        if (attributes === undefined || attributes === null) \r\n        {\r\n            attributes = {};\r\n        }\r\n\r\n        try\r\n        {\r\n            /**\r\n             * @type {SignUpOutput} The output of the Amplify signUp request\r\n             */\r\n            let signUpOutput = await signUp\r\n            ({\r\n                username,\r\n                password,\r\n                options: \r\n                {\r\n                    userAttributes: attributes,\r\n                }\r\n            });\r\n\r\n            return signUpOutput;\r\n        }\r\n        catch(error)\r\n        {\r\n            // Standardize common Cognito error messages for consistent error handling.\r\n            let errorMessage = error.message;\r\n            \r\n            if (error.name === 'UsernameExistsException') \r\n            {\r\n                errorMessage = 'User already exists.';\r\n            } \r\n            else if (error.name === 'InvalidPasswordException') \r\n            {\r\n                // The specific password policy message can vary, so we generalize it.\r\n                errorMessage = 'Invalid password format. The password does not meet the policy requirements.';\r\n            } \r\n            else if (error.message.includes('Password did not conform with policy')) \r\n            {\r\n                // Catch another variant of the password policy error.\r\n                errorMessage = 'Invalid password format. The password does not meet the policy requirements.';\r\n            }\r\n\r\n            throw new Error(`web-cognito-api sign-up-api SignUp() Error: ${errorMessage}`);\r\n        }\r\n        \r\n    } //END SignUp() Method\r\n\r\n    //#endregion\r\n\r\n} //END ConfigureApi Class","/**\r\n * confirm-sign-up-api.js\r\n * @file Handles API requests related to confirming sign-up with the Amplify Cognito Api.\r\n * @description Provides a singleton class, `ConfirmSignUpApi`. \r\n * This file centralizes all Amplify Cognito sign-up confirmation logic.\r\n * The `ConfirmSignUpApi` class here is created automatically by the CognitoApiManager class during construction\r\n * @exports {ConfirmSignUpApi}\r\n * @requires {CognitoApiManager} from '../cognito-api-manager.js'\r\n * @requires {Joi} for schema validation\r\n */\r\n\r\n//#region IMPORTS\r\n\r\n// Importing Amplify From the AWS Amplify Lib\r\nimport { Amplify } from '@aws-amplify/core';\r\n\r\n// Import the confirmSignUp method from the auth library\r\nimport { confirmSignUp } from '@aws-amplify/auth';\r\n\r\n/**\r\n * @typedef {import('@aws-amplify/auth').ConfirmSignUpOutput} ConfirmSignUpOutput\r\n */\r\n\r\n//#endregion\r\n\r\n/**\r\n * Handles sign-up confirmation logic within the AWS Amplify Api\r\n */\r\nexport class ConfirmSignUpApi \r\n{\r\n\r\n    //#region PRIVATE - VARIABLES\r\n\r\n    //#endregion\r\n\r\n    //#region PUBLIC - CONSTRUCTOR\r\n\r\n    /**\r\n     * Constructor for the Api\r\n     */\r\n    //----------------------------------------------//\r\n    constructor() \r\n    //----------------------------------------------//\r\n    {\r\n\r\n    } //END Constructor Method\r\n\r\n    //#endregion\r\n\r\n    //#region PUBLIC - CONFIRM SIGN UP\r\n\r\n    /**\r\n     * Confirms a new user within the Cognito user pool. \r\n     * \r\n     * @documentation https://docs.amplify.aws/javascript/build-a-backend/auth/connect-your-frontend/sign-up/\r\n     * @param {ConfirmSignUpInput} confirmSignUpInput The object holding onto our data used to confirm our account sign up with the Cognito Api\r\n     * @returns {Promise<ConfirmSignUpOutput>} The 'ConfirmSignUpOutput' property returned by Amplify after a user confirms sign up\r\n     */\r\n    // ----------------------------------------------------------------- //\r\n    async ConfirmSignUp( confirmSignUpInput ) \r\n    // ----------------------------------------------------------------- //\r\n    {\r\n        try\r\n        {\r\n            console.log( confirmSignUpInput );\r\n\r\n            /**\r\n             * @type {import('@aws-amplify/auth').ConfirmSignUpOutput} The output of the Amplify confirmSignUp request\r\n             */\r\n            const confirmSignUpOutput = await confirmSignUp( confirmSignUpInput );\r\n            \r\n            return confirmSignUpOutput;\r\n        }\r\n        catch( error )\r\n        {\r\n            // Standardize common Cognito error messages for consistent error handling.\r\n            const errorMessage = error.message;\r\n\r\n            throw new Error(`ConfirmSignUp Error: ${errorMessage}`);\r\n        }\r\n        \r\n    } //END ConfirmSignUp() Method\r\n\r\n    //#endregion\r\n\r\n} //END ConfigureApi Class","/**\r\n * cognito-api-manager.js\r\n * @file Singleton class for interacting with the Cognito API.\r\n * @description This file exports the CognitoApiManager singleton, \r\n * which centralizes AWS Cognito requests \r\n * @exports {CognitoApiManager}\r\n */\r\n\r\n//#region IMPORTS\r\n\r\nimport { ConfigureApi } from './configure/configure-api.js';\r\nimport { SignUpApi } from './sign-up/sign-up-api.js';\r\nimport { ConfirmSignUpApi } from './confirm-sign-up/confirm-sign-up-api.js';\r\n\r\n//#endregion\r\n\r\n/**\r\n * Singleton class for interacting with the Cognito API\r\n * @class\r\n */\r\nexport class CognitoApiManager \r\n{\r\n    \r\n    //#region PRIVATE - VARIABLES\r\n\r\n    /** \r\n     * @private\r\n     * @type {ConfigureApi} \r\n     **/\r\n    #configureApi = null;\r\n\r\n    /** \r\n     * @private\r\n     * @type {SignUpApi} \r\n     **/\r\n    #signUpApi = null;\r\n\r\n    /** \r\n     * @private\r\n     * @type {ConfirmSignUpApi} \r\n     **/\r\n    #confirmSignUpApi = null;\r\n\r\n    //#endregion\r\n\r\n    //#region PUBLIC - VARIABLES\r\n\r\n    //#endregion\r\n\r\n    //#region PUBLIC - CONSTRUCTOR\r\n\r\n    /**\r\n     * Initializes the CognitoApiManager singleton, preparing it for use\r\n     */\r\n    //------------------------------------------------//\r\n    constructor() \r\n    //------------------------------------------------//\r\n    {\r\n        // Singleton check\r\n        if (CognitoApiManager.instance) \r\n        {\r\n            return CognitoApiManager.instance;\r\n        }\r\n\r\n        // Sets the singleton reference so we know we've already called the constructor, preventing duplicates\r\n        CognitoApiManager.instance = this;\r\n\r\n        //We only need to generate our helper classes once\r\n        this.#configureApi = new ConfigureApi(this);\r\n        this.#signUpApi = new SignUpApi(this);\r\n        this.#confirmSignUpApi = new ConfirmSignUpApi(this);\r\n        \r\n    } //END constructor() Method\r\n\r\n    //#endregion\r\n    \r\n    //#region PUBLIC - GET INSTANCE\r\n\r\n    /**\r\n     * Get the single instance of the CognitoApiManager\r\n     * @returns {CognitoApiManager} The CognitoApiManager instance\r\n     */\r\n    // ----------------------------------------------------------------- //\r\n    static GetInstance() \r\n    // ----------------------------------------------------------------- //\r\n    {\r\n        if( !CognitoApiManager.instance )\r\n        {\r\n            CognitoApiManager.instance = new CognitoApiManager();\r\n        }\r\n\r\n        return CognitoApiManager.instance;\r\n\r\n    } //END GetInstance() Method\r\n\r\n    //#endregion\r\n\r\n    //#region PUBLIC - SHORTCUTS - ConfigureApi\r\n\r\n    /**\r\n     * Sets the Amplify configuration file\r\n     * \r\n     * @documentation https://docs.amplify.aws/javascript/start/connect-to-aws-resources/\r\n     * \r\n     * @param {import('@aws-amplify/core').ResourcesConfig} config The 'amplifyconfiguration.json' config file\r\n     * @returns {Promise<import('@aws-amplify/core').ResourcesConfig>} The resources configuration set up with Amplify\r\n     */\r\n    async Configure( config ){ return this.#configureApi.Configure( config ); }\r\n\r\n    //#endregion\r\n\r\n    //#region PUBLIC - SHORTCUTS - SignUpApi\r\n\r\n    /**\r\n     * Creates a new user within the Cognito user pool. \r\n     * Check the `SignUpOutput` variable for the next step, usually you'll need to pass in a code to continue sign up\r\n     * \r\n     * @documentation https://docs.amplify.aws/javascript/build-a-backend/auth/connect-your-frontend/sign-up/\r\n     * \r\n     * @param {string} username The name for the new user. Specific format depends on the user pool settings in your AWS console.\r\n     * @param {string} password The password for the new user\r\n     * @param {object | null} [attributes] [Optional] An object of user attributes, e.g., { email: 'user@example.com' }\r\n     * @returns {Promise<import('@aws-amplify/auth').SignUpOutput>} The 'SignUpOutput' property returned by Amplify after a user is successfully created in the user pool\r\n     */\r\n    async SignUp( username, password, attributes ){ return this.#signUpApi.SignUp( username, password, attributes ); }\r\n\r\n    //#endregion\r\n\r\n    //#region PUBLIC - SHORTCUTS - ConfirmSignUpApi\r\n\r\n    /**\r\n     * Confirms a new user within the Cognito user pool. \r\n     * \r\n     * @documentation https://docs.amplify.aws/javascript/build-a-backend/auth/connect-your-frontend/sign-up/\r\n     * @param {ConfirmSignUpInput} confirmSignUpInput The object holding onto our data used to confirm our account sign up with the Cognito Api\r\n     * @returns {Promise<import('@aws-amplify/auth').ConfirmSignUpOutput>} The 'ConfirmSignUpOutput' property returned by Amplify after a user confirms sign up\r\n     */\r\n    async ConfirmSignUp( confirmSignUpInput ){ return this.#confirmSignUpApi.ConfirmSignUp( confirmSignUpInput ); }\r\n\r\n    //#endregion\r\n\r\n} //END CognitoApiManager Class"],"names":["ConfigureApi","config","Amplify","error","SignUpApi","username","password","attributes","signUp","errorMessage","ConfirmSignUpApi","confirmSignUpInput","confirmSignUp","CognitoApiManager","#configureApi","#signUpApi","#confirmSignUpApi"],"mappings":"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"}