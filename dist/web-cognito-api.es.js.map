{"version":3,"file":"web-cognito-api.es.js","sources":["../src/configure/configure-api.js","../src/sign-up/sign-up-api.js","../src/cognito-api-manager.js"],"sourcesContent":["/**\r\n * configure-api.js\r\n * @file Handles API requests related to configuring the Amplify Api.\r\n * @description Provides a singleton class, `ConfigureApi`. \r\n * This file centralizes all Amplify configuration logic.\r\n * The `ConfigureApi` class here is created automatically by the CognitoApiManager class during construction\r\n * @exports {ConfigureApi}\r\n * @requires {CognitoApiManager} from '../cognito-api-manager.js'\r\n * @requires {Joi} for schema validation\r\n */\r\n\r\n//#region IMPORTS\r\n\r\n// Importing Amplify From the AWS Amplify Lib\r\nimport { Amplify } from '@aws-amplify/core';\r\n\r\n/**\r\n * @typedef {import('@aws-amplify/core').ResourcesConfig} ResourcesConfig\r\n */\r\n\r\n//#endregion\r\n\r\n/**\r\n * Handles configuration of the AWS Amplify Api\r\n */\r\nexport class ConfigureApi \r\n{\r\n\r\n    //#region PRIVATE - VARIABLES\r\n\r\n    //#endregion\r\n\r\n    //#region PUBLIC - CONSTRUCTOR\r\n\r\n    /**\r\n     * Constructor for the Api\r\n     */\r\n    //----------------------------------------------//\r\n    constructor() \r\n    //----------------------------------------------//\r\n    {\r\n\r\n    } //END Constructor Method\r\n\r\n    //#endregion\r\n\r\n    //#region PUBLIC - CONFIGURE\r\n\r\n    /**\r\n     * Sets the Amplify configuration file\r\n     * \r\n     * @documentation https://docs.amplify.aws/javascript/start/connect-to-aws-resources/\r\n     * \r\n     * @param {ResourcesConfig} config The 'amplifyconfiguration.json' config file\r\n     * @returns {Promise<ResourcesConfig>} The resources configuration set up with Amplify\r\n     */\r\n    // ----------------------------------------------------------------- //\r\n    async Configure( config ) \r\n    // ----------------------------------------------------------------- //\r\n    {\r\n        if( config === undefined || config === null )\r\n        {\r\n            Promise.reject( new Error( \"web-cognito-api configure.js Configure() passed in 'config' parameter is undefined or null\" ) );\r\n        }\r\n\r\n        try\r\n        {\r\n            /**\r\n             * Passes our configuration file into the core Amplify object\r\n             */\r\n            Amplify.configure(config);\r\n\r\n            return Amplify.getConfig();\r\n        }\r\n        catch(error)\r\n        {\r\n            Promise.reject( new Error( \"web-cognito-api configure.js Configure() Error: \" + error ) );\r\n        }\r\n        \r\n    } //END Configure() Method\r\n\r\n    //#endregion\r\n    \r\n} //END ConfigureApi Class","/**\r\n * sign-up-api.js\r\n * @file Handles API requests related to sign-up with the Amplify Cognito Api.\r\n * @description Provides a singleton class, `SignUpApi`. \r\n * This file centralizes all Amplify Cognito sign-up logic.\r\n * The `SignUpApi` class here is created automatically by the CognitoApiManager class during construction\r\n * @exports {SignUpApi}\r\n * @requires {CognitoApiManager} from '../cognito-api-manager.js'\r\n * @requires {Joi} for schema validation\r\n */\r\n\r\n//#region IMPORTS\r\n\r\n// Importing Amplify From the AWS Amplify Lib\r\nimport { Amplify } from '@aws-amplify/core';\r\n\r\n// Import the signUp method from the auth library\r\nimport { signUp } from '@aws-amplify/auth';\r\n\r\n/**\r\n * @typedef {import('@aws-amplify/core').ResourcesConfig} ResourcesConfig\r\n * @typedef {import('@aws-amplify/auth/dist/esm/types').AuthNextSignUpStep} AuthNextSignUpStep\r\n * @typedef {import('@aws-amplify/auth').SignUpOutput} SignUpOutput\r\n */\r\n\r\n//#endregion\r\n\r\n/**\r\n * Handles sign-up logic within the AWS Amplify Api\r\n */\r\nexport class SignUpApi \r\n{\r\n\r\n    //#region PRIVATE - VARIABLES\r\n\r\n    //#endregion\r\n\r\n    //#region PUBLIC - CONSTRUCTOR\r\n\r\n    /**\r\n     * Constructor for the Api\r\n     */\r\n    //----------------------------------------------//\r\n    constructor() \r\n    //----------------------------------------------//\r\n    {\r\n\r\n    } //END Constructor Method\r\n\r\n    //#endregion\r\n\r\n    //#region PUBLIC - SIGN UP\r\n\r\n    /**\r\n     * Creates a new user within the Cognito user pool. \r\n     * Check the `SignUpOutput` variable for the next step, usually you'll need to pass in a code to continue sign up\r\n     * \r\n     * @documentation https://docs.amplify.aws/javascript/build-a-backend/auth/connect-your-frontend/sign-up/\r\n     * \r\n     * @param {string} username The name for the new user. Specific format depends on the user pool settings in your AWS console.\r\n     * @param {string} password The password for the new user\r\n     * @param {object | null} attributes [Optional] An object of user attributes, e.g., { email: 'user@example.com' }\r\n     * @returns {Promise<SignUpOutput>} The 'SignUpOutput' property returned by Amplify after a user is successfully created in the user pool\r\n     */\r\n    // ----------------------------------------------------------------- //\r\n    async SignUp( username, password, attributes ) \r\n    // ----------------------------------------------------------------- //\r\n    {\r\n        if (!username) \r\n        {\r\n            return Promise.reject( new Error(\"web-cognito-api sign-up-api.js SignUp() Error: username cannot be null, undefined, or empty.\" ) );\r\n        }\r\n\r\n        if (!password) \r\n        {\r\n            return Promise.reject( new Error(\"web-cognito-api sign-up-api SignUp() Error: password cannot be null, undefined, or empty.\" ) );\r\n        }\r\n\r\n        if (attributes === undefined || attributes === null) \r\n        {\r\n            attributes = {};\r\n        }\r\n\r\n        try\r\n        {\r\n            /**\r\n             * @type {SignUpOutput} The output of the Amplify signUp request\r\n             */\r\n            let signUpOutput = await signUp\r\n            ({\r\n                username,\r\n                password,\r\n                options: \r\n                {\r\n                    userAttributes: attributes,\r\n                }\r\n            });\r\n\r\n            return signUpOutput;\r\n        }\r\n        catch(error)\r\n        {\r\n            return Promise.reject( new Error(\"web-cognito-api sign-up-api SignUp() Error: \" + error ));\r\n        }\r\n        \r\n    } //END SignUp() Method\r\n\r\n    //#endregion\r\n\r\n} //END ConfigureApi Class","/**\r\n * cognito-api-manager.js\r\n * @file Singleton class for interacting with the Cognito API.\r\n * @description This file exports the CognitoApiManager singleton, \r\n * which centralizes AWS Cognito requests \r\n * @exports {CognitoApiManager}\r\n */\r\n\r\n//#region IMPORTS\r\n\r\nimport { ConfigureApi } from './configure/configure-api.js';\r\nimport { SignUpApi } from './sign-up/sign-up-api.js';\r\n\r\n//#endregion\r\n\r\n/**\r\n * Singleton class for interacting with the Cognito API\r\n * @class\r\n */\r\nexport class CognitoApiManager \r\n{\r\n    \r\n    //#region PRIVATE - VARIABLES\r\n\r\n    /** \r\n     * Reference to the ConfigureAPI object\r\n     * @type {ConfigureApi} \r\n     * @private\r\n     * */\r\n    configureApi = null;\r\n\r\n    /** \r\n     * Reference to the SignUpApi object\r\n     * @type {SignUpApi} \r\n     * @private\r\n     * */\r\n    signUpApi = null;\r\n\r\n    //#endregion\r\n\r\n    //#region PUBLIC - VARIABLES\r\n\r\n    //#endregion\r\n\r\n    //#region PUBLIC - CONSTRUCTOR\r\n\r\n    /**\r\n     * Initializes the CognitoApiManager singleton, preparing it for use\r\n     */\r\n    //------------------------------------------------//\r\n    constructor() \r\n    //------------------------------------------------//\r\n    {\r\n        // Singleton check\r\n        if (CognitoApiManager.instance) \r\n        {\r\n            return CognitoApiManager.instance;\r\n        }\r\n\r\n        // Sets the singleton reference so we know we've already called the constructor, preventing duplicates\r\n        CognitoApiManager.instance = this;\r\n\r\n        //We only need to generate our helper classes once\r\n        this.configureApi = new ConfigureApi(this);\r\n        this.signUpApi = new SignUpApi(this);\r\n        \r\n    } //END constructor() Method\r\n\r\n    //#endregion\r\n    \r\n    //#region PUBLIC - GET INSTANCE\r\n\r\n    /**\r\n     * Get the single instance of the CognitoApiManager\r\n     * @returns {CognitoApiManager} The CognitoApiManager instance\r\n     */\r\n    // ----------------------------------------------------------------- //\r\n    static GetInstance() \r\n    // ----------------------------------------------------------------- //\r\n    {\r\n        if( !CognitoApiManager.instance )\r\n        {\r\n            CognitoApiManager.instance = new CognitoApiManager();\r\n        }\r\n\r\n        return CognitoApiManager.instance;\r\n\r\n    } //END GetInstance() Method\r\n\r\n    //#endregion\r\n\r\n    //#region PUBLIC - SHORTCUTS - ConfigureApi\r\n\r\n    /**\r\n     * Sets the Amplify configuration file\r\n     * \r\n     * @documentation https://docs.amplify.aws/javascript/start/connect-to-aws-resources/\r\n     * \r\n     * @param {import('@aws-amplify/core').ResourcesConfig} config The 'amplifyconfiguration.json' config file\r\n     * @returns {Promise<import('@aws-amplify/core').ResourcesConfig>} The resources configuration set up with Amplify\r\n     */\r\n    async Configure( config ){ return this.configureApi.Configure( config ); }\r\n\r\n    //#endregion\r\n\r\n    //#region PUBLIC - SHORTCUTS - SignUpApi\r\n\r\n    /**\r\n     * Creates a new user within the Cognito user pool. \r\n     * Check the `SignUpOutput` variable for the next step, usually you'll need to pass in a code to continue sign up\r\n     * \r\n     * @documentation https://docs.amplify.aws/javascript/build-a-backend/auth/connect-your-frontend/sign-up/\r\n     * \r\n     * @param {string} username The name for the new user. Specific format depends on the user pool settings in your AWS console.\r\n     * @param {string} password The password for the new user\r\n     * @param {object | null} [attributes] [Optional] An object of user attributes, e.g., { email: 'user@example.com' }\r\n     * @returns {Promise<import('@aws-amplify/auth').SignUpOutput>} The 'SignUpOutput' property returned by Amplify after a user is successfully created in the user pool\r\n     */\r\n    async SignUp( username, password, attributes ){ return this.signUpApi.SignUp( username, password, attributes ); }\r\n\r\n    //#endregion\r\n\r\n} //END CognitoApiManager Class"],"names":["ConfigureApi","config","Amplify","error","SignUpApi","username","password","attributes","signUp","CognitoApiManager"],"mappings":";;AAyBO,MAAMA,EACb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYI,cAEA;AAAA,EAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAeA,MAAM,UAAWC,GAEjB;AACI,IAA4BA,KAAW,QAEnC,QAAQ,OAAQ,IAAI,MAAO,4FAA4F,CAAE;AAG7H,QACA;AAII,aAAAC,EAAQ,UAAUD,CAAM,GAEjBC,EAAQ;IACnB,SACMC,GACN;AACI,cAAQ,OAAQ,IAAI,MAAO,qDAAqDA,CAAK,CAAE;AAAA,IAC3F;AAAA,EAEJ;AAAA;AAAA;AAIJ;ACrDO,MAAMC,EACb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAYI,cAEA;AAAA,EAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAkBA,MAAM,OAAQC,GAAUC,GAAUC,GAElC;AACI,QAAI,CAACF;AAED,aAAO,QAAQ,OAAQ,IAAI,MAAM,8FAA8F,CAAE;AAGrI,QAAI,CAACC;AAED,aAAO,QAAQ,OAAQ,IAAI,MAAM,2FAA2F,CAAE;AAGlI,IAAgCC,KAAe,SAE3CA,IAAa,CAAA;AAGjB,QACA;AAcI,aAVmB,MAAMC,EACxB;AAAA,QACG,UAAAH;AAAA,QACA,UAAAC;AAAA,QACA,SACA;AAAA,UACI,gBAAgBC;AAAA,QACpC;AAAA,MACA,CAAa;AAAA,IAGL,SACMJ,GACN;AACI,aAAO,QAAQ,OAAQ,IAAI,MAAM,iDAAiDA,CAAK,CAAE;AAAA,IAC7F;AAAA,EAEJ;AAAA;AAAA;AAIJ;AC1FO,MAAMM,EACb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASI,eAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOf,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAcZ,cAEA;AAEI,QAAIA,EAAkB;AAElB,aAAOA,EAAkB;AAI7B,IAAAA,EAAkB,WAAW,MAG7B,KAAK,eAAe,IAAIT,EAAa,IAAI,GACzC,KAAK,YAAY,IAAII,EAAU,IAAI;AAAA,EAEvC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,OAAO,cAEP;AACI,WAAKK,EAAkB,aAEnBA,EAAkB,WAAW,IAAIA,MAG9BA,EAAkB;AAAA,EAE7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAcA,MAAM,UAAWR,GAAQ;AAAE,WAAO,KAAK,aAAa,UAAWA,CAAM;AAAA,EAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAiBzE,MAAM,OAAQI,GAAUC,GAAUC,GAAY;AAAE,WAAO,KAAK,UAAU,OAAQF,GAAUC,GAAUC,CAAU;AAAA,EAAI;AAAA;AAIpH;"}